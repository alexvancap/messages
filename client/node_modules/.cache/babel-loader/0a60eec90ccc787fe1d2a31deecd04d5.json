{"ast":null,"code":"var _jsxFileName = \"/Users/alexandervancappellen/Desktop/messages/client/src/components/login/Login.js\";\nimport React, { useEffect } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport history from '../../history';\nimport { LoginForm } from './LoginForm';\nimport io from 'socket.io-client';\nimport constants from './../../constants'; // import {useSelector, useDispatch} from 'react-redux'\n\nexport const Login = () => {\n  const loginData = useSelector(state => state.loginForm);\n  const dispatch = useDispatch();\n  const token = sessionStorage['authToken'];\n  if (token !== undefined) console.log(token);\n  fetch(`${constants.backendUrl}/authenticate-token`, {\n    headers: {\n      'Content-Type': 'Application/json',\n      'Authorization': token\n    }\n  }).then(res => res.json()).then(res => {\n    dispatch({\n      type: 'SAVE_USER_DATA',\n      data: res.data\n    });\n    const socket = io.connect(constants.backendUrl, {\n      'query': 'token=' + tokemn\n    });\n    dispatch({\n      type: 'SAVE_SOCKET',\n      socket: socket\n    });\n    history.push('/');\n  });\n\n  const handleLogin = e => {\n    e.preventDefault();\n    fetch('http://localhost:5000/login', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': `Bearer ${localStorage['authToken']}`\n      },\n      body: JSON.stringify({\n        username: loginData.username,\n        password: loginData.password,\n        rememberUser: loginData.checkedBox\n      })\n    }).then(res => res.json()).then(res => {\n      if (res.data) {\n        dispatch({\n          type: 'SAVE_USER_DATA',\n          data: res.data\n        });\n        if (typeof res.token !== 'undefined') sessionStorage.setItem('authToken', res.token);\n        dispatch({\n          type: 'LOGIN_FORM_CHANGE',\n          key: 'formSubmitted',\n          value: false\n        });\n        const socket = io.connect(constants.backendUrl, {\n          'query': 'token=' + res.token\n        });\n        dispatch({\n          type: 'SAVE_SOCKET',\n          socket: socket\n        });\n        history.push('/');\n      } else {\n        console.log(res.message);\n      }\n    });\n  };\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    id: \"loginContainer\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    id: \"login-text\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 13\n    }\n  }, \"Welcome, please log in or register below.\"), /*#__PURE__*/React.createElement(LoginForm, {\n    loginData: loginData,\n    handleLogin: handleLogin,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 13\n    }\n  }));\n};","map":{"version":3,"sources":["/Users/alexandervancappellen/Desktop/messages/client/src/components/login/Login.js"],"names":["React","useEffect","useDispatch","useSelector","history","LoginForm","io","constants","Login","loginData","state","loginForm","dispatch","token","sessionStorage","undefined","console","log","fetch","backendUrl","headers","then","res","json","type","data","socket","connect","tokemn","push","handleLogin","e","preventDefault","method","localStorage","body","JSON","stringify","username","password","rememberUser","checkedBox","setItem","key","value","message"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react'\nimport { useDispatch, useSelector } from 'react-redux'\nimport history from '../../history'\nimport { LoginForm } from './LoginForm'\nimport io from 'socket.io-client';\nimport constants from './../../constants'\n// import {useSelector, useDispatch} from 'react-redux'\n\nexport const Login = () => {\n    const loginData = useSelector(state => state.loginForm)\n    const dispatch = useDispatch()\n\n    const token = sessionStorage['authToken']\n    if(token !== undefined)\n        console.log(token)\n        fetch(`${constants.backendUrl}/authenticate-token`, {\n            headers: {\n                'Content-Type': 'Application/json',\n                'Authorization': token\n            }\n        }).then((res) => res.json())\n        .then((res) => {\n            dispatch({type: 'SAVE_USER_DATA', data: res.data})\n            const socket = io.connect(constants.backendUrl, {\n                'query': 'token=' + tokemn\n            });\n            dispatch({type: 'SAVE_SOCKET', socket: socket})\n            history.push('/')\n        })\n\n    const handleLogin = (e) => {\n        e.preventDefault()\n        fetch('http://localhost:5000/login', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': `Bearer ${localStorage['authToken']}`\n            },\n            body: JSON.stringify({\n                username: loginData.username,\n                password: loginData.password,\n                rememberUser: loginData.checkedBox\n            })\n        }).then(res => res.json())\n        .then(res => {\n            if(res.data){\n                dispatch({type: 'SAVE_USER_DATA', data: res.data})\n                if(typeof(res.token) !== 'undefined') sessionStorage.setItem('authToken', res.token)\n                dispatch({type: 'LOGIN_FORM_CHANGE', key: 'formSubmitted', value: false})\n                const socket = io.connect(constants.backendUrl, {\n                    'query': 'token=' + res.token\n                });\n                dispatch({type: 'SAVE_SOCKET', socket: socket})\n                history.push('/')\n            }else{\n                console.log(res.message)\n            }\n        })\n    }\n\n    return (\n        <div id=\"loginContainer\">\n            <p id=\"login-text\">Welcome, please log in or register below.</p>\n            <LoginForm \n                loginData={loginData} \n                handleLogin={handleLogin} \n            />\n        </div>\n    )\n}"]},"metadata":{},"sourceType":"module"}